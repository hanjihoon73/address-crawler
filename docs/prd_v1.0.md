# 제품 요구사항 문서 (PRD)

**프로젝트명:** Address Crawler (주소 수집기)
**버전:** 1.0.0
**날짜:** 2026-02-03
**상태:** 완료됨

---

## 1. 프로젝트 개요
**Address Crawler**는 사용자가 입력한 키워드를 기반으로 네이버 지도에서 업체를 검색하고, 해당 업체의 주소 정보(상호명, 도로명 주소, 지번 주소 등)를 추출하여 엑셀 파일로 다운로드할 수 있는 웹 애플리케이션입니다.

## 2. 기술 스택
| 구분 | 기술 | 버전 | 비고 |
| :--- | :--- | :--- | :--- |
| **프론트엔드** | Next.js | 16.1.6 | App Router, Turbopack 사용 |
| **언어** | TypeScript | 5.x | 엄격한 타입 확인 적용 |
| **UI 라이브러리** | React | 19.x | 컴포넌트 기반 UI 구성 |
| **스타일링** | Vanilla CSS | - | CSS Modules (`page.module.css`), `globals.css` |
| **크롤링** | Puppeteer | 24.x | 헤드리스 브라우저 자동화 |
| **엑셀** | xlsx | 0.18.5 | 데이터 엑셀 내보내기 |
| **아이콘** | Lucide React | 0.563.0 | UI 아이콘 |

## 3. 핵심 기능

### 3.1. 키워드 검색
- **기능**: 사용자가 검색할 키워드(예: "강남역 카페")와 수집할 항목 수를 입력하여 조회를 시작합니다.
- **UI**: 직관적인 검색 바와 수집 개수 설정(숫자 입력) 인터페이스를 제공합니다.

### 3.2. 데이터 크롤링
- **대상**: 네이버 지도 PC 버전 (https://map.naver.com)
- **동작 방식**:
  - `Puppeteer`를 사용하여 백그라운드에서 브라우저를 실행합니다.
  - 키워드로 검색을 수행하고 `#searchIframe` 내부의 리스트를 탐색합니다.
  - 요청된 수집 개수를 충족하기 위해 자동으로 스크롤 및 페이지 이동(페이지네이션)을 수행합니다.
- **추출 필드**:
  - **상호명**: `.place_bluelink` 내부의 첫 번째 `<span>` 태그 텍스트만 추출하여 불필요한 카테고리 정보 포함을 방지했습니다.
  - **기본 주소**: 거리 정보(예: "11km") 주변 텍스트 앵커링을 통해 기본 주소를 파악합니다.
  - **상세 주소(지번/도로명)**: "상세주소" 버튼을 클릭하여 펼쳐진 정보에서 파싱합니다.

### 3.3. 결과 표시
- **테이블 뷰**: 수집된 데이터(No, 상호명, 지번 주소, 도로명 주소 등)를 실시간 또는 완료 후 테이블 형태로 보여줍니다.
- **진행 상태**: 수집 중임을 알리는 원형 로딩 스피너 애니메이션을 중앙에 표시합니다.

### 3.4. 엑셀 다운로드
- **기능**: 수집된 결과 테이블을 엑셀 파일(`.xlsx`)로 다운로드할 수 있는 버튼을 제공합니다.

## 4. 시스템 로직 및 아키텍처

### 4.1. 폴더 구조
```
src/
├── app/
│   ├── page.tsx          # 메인 UI (검색창, 결과 테이블 등)
│   ├── api/crawl/        # 크롤링 수행 Next.js API 라우트
│   └── globals.css       # 전역 스타일
├── components/
│   ├── common/           # 공통 컴포넌트 (버튼 등)
│   └── search/           # 검색 폼 관련 컴포넌트
├── hooks/
│   └── useMapCrawler.ts  # API 통신 및 상태 관리를 위한 커스텀 훅
└── utils/
    └── crawler.ts        # Puppeteer 핵심 크롤링 로직
```

### 4.2. 주요 로직 상세
- **API 통신**: 프론트엔드에서 `useMapCrawler` 훅을 통해 `/api/crawl` 엔드포인트를 호출합니다.
- **크롤러 로직 (`crawler.ts`)**:
  - 안정적인 실행을 위해 `--no-sandbox` 옵션으로 브라우저를 띄웁니다.
  - 네이버 지도의 동적 iFrame 구조(`#searchIframe`)에 맞춰 컨텍스트를 전환합니다.
  - **상호명 추출**: `.place_bluelink` 요소 전체 텍스트가 아닌 내부 `span` 구조를 분석하여 정확한 상호명만 가져옵니다.
  - **주소 추출**: 다양한 UI 패턴에 대응하기 위해 "거리 정보 기반 탐색 -> 지역명 정규식 -> 버튼 전수 조사" 순서의 3단계 폴백(Fallback) 전략을 사용합니다.
- **에러 처리**: 크롤링 실패 시 UI에 적절한 에러 메시지를 표시합니다.

## 5. 배포 환경
- **플랫폼**: Vercel
- **설정**: 표준 Next.js Output 설정.
- **제약 사항**: Vercel의 Serverless Function 환경에서는 Puppeteer 실행 리소스(메모리/용량) 제한이 있을 수 있어, 로컬 실행 또는 별도 도커 환경에서의 사용이 더 권장됩니다. (현재 프로젝트는 표준 Puppeteer를 사용하며 로컬 및 일반 서버 환경에 최적화됨).

## 6. 히스토리
- **v0.1**: 초기 프로토타입 (기본 지도 크롤링 구현).
- **v1.0**: 프로젝트명 변경(`address-crawler`), UI 개선(로딩 애니메이션), 추출 로직 정교화(상호명/카테고리 분리, 주소 파싱 개선).

---
*이 문서는 Antigravity Agent에 의해 작성되었습니다.*
